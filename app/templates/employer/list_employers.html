{% extends "base.html" %}
{% block title %}Nh√† Tuy·ªÉn D·ª•ng - JobNest{% endblock %}

{% block content %}
<!-- HERO -->
<section class="bg-[var(--primary-blue)] text-white text-center py-10">
  <div class="container mx-auto px-4">
    <h1 class="mb-3 text-3xl font-black">Kh√°m Ph√° Nh√† Tuy·ªÉn D·ª•ng H√†ng ƒê·∫ßu</h1>
    <p class="text-md mb-4">T√¨m ki·∫øm nh√† tuy·ªÉn d·ª•ng theo t√™n c√¥ng ty. K·∫øt n·ªëi v·ªõi c∆° h·ªôi ngh·ªÅ nghi·ªáp t·ªët nh·∫•t.</p>

    <form id="main-search" action="{{ url_for('employer.list_employers') }}" method="get"
          class="bg-white p-4 rounded-lg flex flex-col sm:flex-row sm:items-center sm:gap-3 gap-3">
      <input type="text" name="keyword" placeholder="T√™n c√¥ng ty"
             value="{{ search['keyword'] if search and 'keyword' in search else '' }}"
             class="text-black flex-1 border-2 border-gray-300 rounded-full p-2 text-sm" />

      <!-- Simplified location input (optional, can be enhanced with JS) -->
      <div class="relative flex-1">
        <div id="location-input" class="border-2 border-gray-300 rounded-full p-2 text-gray-400 cursor-pointer text-sm">
          Ch·ªçn ƒë·ªãa ƒëi·ªÉm
        </div>
        <input type="hidden" id="location-hidden" name="city" value="{{ search.city if search and 'city' in search else '' }}">
        <div id="location-dropdown" class="absolute left-0 top-full mt-1 w-full bg-white border rounded shadow z-10 hidden text-black">
          <ul id="province-list" class="p-2"></ul>
        </div>
      </div>

      <button type="submit" class="bg-[var(--primary-blue)] hover:bg-[var(--primary-blue-hover)] text-white px-6 py-2 rounded-full text-sm transition">T√¨m ki·∫øm</button>
    </form>
  </div>
</section>

<!-- EMPLOYER LIST -->
<section class="py-10">
  <div class="container mx-auto px-4">
    <!-- Main content: employers -->
    <main class="flex-1">
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-6">
        {% if employers %}
          {% for employer in employers %}
            <article class="bg-white rounded-lg border border-gray-200 p-6 shadow hover:shadow-md transition flex flex-col justify-between">
              <div class="flex items-start justify-between">
                {% if employer.logo %}
                  <img src="{{ employer.logo }}" alt="{{ employer.company_name }}" class="h-12 w-12 rounded-md object-cover border" />
                {% else %}
                  <div class="h-12 w-12 rounded-md bg-gray-100 flex items-center justify-center text-gray-400">üè¢</div>
                {% endif %}
              </div>

              <h3 class="mt-4 text-lg font-semibold text-gray-800 hover:text-blue-600">
                <a href="{{ url_for('employer.profile', employer_id=employer.id) }}">{{ employer.company_name or 'C√¥ng ty ·∫©n danh' }}</a>
              </h3>

              <div class="mt-2 text-sm text-gray-600 space-y-1">
                <p><i class="fa-solid fa-location-dot mr-1 text-gray-400"></i>{{ employer.city or 'ƒê·ªãa ƒëi·ªÉm ·∫©n danh' }}</p>
                <p><i class="fa-solid fa-briefcase mr-1 text-gray-400"></i>{{ employer.active_jobs_count }} c√¥ng vi·ªác ƒëang m·ªü</p>
              </div>

              <p class="mt-3 text-sm text-gray-700 line-clamp-2">{{ employer.description | truncate(100, true) or 'Kh√¥ng c√≥ m√¥ t·∫£' }}</p>

              <div class="mt-4 flex gap-3">
                <a href="{{ url_for('employer.employer_detail', employer_id=employer.id) }}"
                   class="flex-1 text-center px-4 py-2 border !border-[var(--primary-blue)] rounded-lg text-sm font-medium text-[var(--primary-blue)] hover:bg-[var(--primary-blue)] hover:text-white transition">
                  Chi ti·∫øt
                </a>
              </div>
            </article>
          {% endfor %}
        {% else %}
          <p class="text-center text-gray-500">Kh√¥ng c√≥ nh√† tuy·ªÉn d·ª•ng n√†o.</p>
        {% endif %}
      </div>

      <!-- Pagination -->
      {% if total_pages > 1 %}
      <nav class="mt-6 flex justify-center">
        <ul class="flex space-x-2">
          {% if page > 1 %}
            <li><a href="{{ url_for('list_employers', page=page-1, **search) }}" class="px-3 py-1 border rounded bg-gray-100 hover:bg-gray-200">Tr∆∞·ªõc</a></li>
          {% endif %}
          {% for p in range(1, total_pages + 1) %}
            <li>
              <a href="{{ url_for('list_employers', page=p, **search) }}"
                 class="px-3 py-1 border rounded {% if p == page %} bg-blue-600 text-white {% else %} bg-gray-100 hover:bg-gray-200 {% endif %}">{{ p }}</a>
            </li>
          {% endfor %}
          {% if page < total_pages %}
            <li><a href="{{ url_for('list_employers', page=page+1, **search) }}" class="px-3 py-1 border rounded bg-gray-100 hover:bg-gray-200">Sau</a></li>
          {% endif %}
        </ul>
      </nav>
      {% endif %}
    </main>
  </div>
</section>
{% endblock %}